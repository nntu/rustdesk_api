<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Bảng điều khiển - RustDeskApi</title>
    {% load static %}
    <link rel="stylesheet" href="{% static 'css/global.css' %}">
    <link rel="stylesheet" href="{% static 'css/home.css' %}">
    <link rel="stylesheet" href="{% static 'css/nav1.css' %}">
    <link rel="stylesheet" href="{% static 'css/nav2.css' %}">
    <style>
        /* Toast nhẹ (chỉ dùng trang này) */
        .toast-container {
            position: fixed;
            top: 16px;
            left: 50%;
            transform: translateX(-50%);
            z-index: 9999;
            display: flex;
            flex-direction: column;
            gap: 8px;
            align-items: center
        }

        .toast {
            min-width: 100px;
            max-width: 80vw;
            color: #fff;
            border-radius: 6px;
            padding: 10px 16px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, .2);
            opacity: 0;
            transform: translateY(-6px);
            transition: opacity .18s ease, transform .18s ease;
            text-align: center;
            word-wrap: break-word;
            word-break: break-word;
            white-space: normal;
            width: auto
        }

        .toast--show {
            opacity: 1;
            transform: translateY(0)
        }

        .toast--error {
            background: rgba(185, 28, 28, .95)
        }

        .toast--success {
            background: rgba(22, 163, 74, .95)
        }

        .toast--info {
            background: rgba(37, 99, 235, .95)
        }
    </style>
</head>
<body data-current-user="{{ user.username }}">
<header class="header">
    <div class="title">Bảng điều khiển</div>
    <div class="user-actions">
        <span>Xin chào, {{ username }}!</span>
        <a href="{% url 'web_logout' %}">Đăng xuất</a>
    </div>
</header>
<div class="layout">
    <aside class="sidebar" role="navigation" aria-label="Thanh điều hướng bên">
        <div class="brand">Điều hướng</div>
        <nav>
            <ul class="nav">
                <li><a href="#" data-key="nav-1">Trang chủ</a></li>
                <li><a href="#" data-key="nav-2">Quản lý thiết bị</a></li>
                <li><a href="#" data-key="nav-3">Quản lý người dùng</a></li>
                <li><a href="#" data-key="nav-4">Sổ địa chỉ</a></li>
            </ul>
        </nav>
    </aside>
    <main id="content" class="content" role="main" aria-live="polite" aria-busy="false">
        <div class="content-empty" id="empty-hint">Vui lòng chọn một mục điều hướng bên trái để xem nội dung</div>
    </main>
</div>

<!-- Thêm thiết bị vào sổ địa chỉ -->
<div id="nav2-add-to-book-root" class="modal-backdrop" aria-hidden="true">
    <div class="modal modal--sm" role="dialog" aria-modal="true" aria-labelledby="nav2-add-to-book-title">
        <div class="modal-header">
            <h3 id="nav2-add-to-book-title" class="modal-title">Thêm thiết bị vào sổ địa chỉ</h3>
            <button type="button" class="modal-close" data-close="nav2-add-to-book" aria-label="Đóng">
                <img src="{% static 'icons/close.svg' %}" width="16" height="16" alt="" aria-hidden="true">
            </button>
        </div>
        <div class="modal-body">
            <form id="nav2-add-to-book-form">
                <input type="hidden" name="peer_id" id="nav2-add-to-book-peer-id">
                <div class="nav2-form-row">
                    <label style="min-width:88px;color:#6a737d;">ID thiết bị</label>
                    <span id="nav2-add-to-book-peer-id-display" style="color:#24292e;"></span>
                </div>
                <div class="nav2-form-row">
                    <label for="nav2-add-to-book-guid" style="min-width:88px;color:#6a737d;">Chọn sổ địa chỉ</label>
                    <select class="nav2-select" name="guid" id="nav2-add-to-book-guid" required style="flex:1;">
                        <option value="" disabled selected hidden>Vui lòng chọn sổ địa chỉ</option>
                    </select>
                </div>
                <div class="nav2-form-row">
                    <label for="nav2-add-to-book-alias" style="min-width:88px;color:#6a737d;">Tên thiết bị</label>
                    <input class="nav2-input nav2-input-full" type="text" name="alias" id="nav2-add-to-book-alias"
                           placeholder="Nhập tên thiết bị (tùy chọn)">
                </div>
                <div style="display:flex;gap:8px;justify-content:flex-end;">
                    <button type="button" class="nav2-btn" data-close="nav2-add-to-book">Hủy</button>
                    <button type="submit" class="nav2-btn nav2-primary">Thêm</button>
                </div>
            </form>
        </div>
    </div>
</div>

<!-- Nhập các tệp JavaScript module hóa -->
<script src="{% static 'js/constants.js' %}"></script>
<script src="{% static 'js/utils.js' %}"></script>
<script src="{% static 'js/modal.js' %}"></script>
<script src="{% static 'js/navigation.js' %}"></script>
<script src="{% static 'js/nav2.js' %}"></script>
<script src="{% static 'js/nav3.js' %}"></script>
<script src="{% static 'js/nav4.js' %}"></script>
<script src="{% static 'js/events.js' %}"></script>

<!-- Chèn biến template Django (< 50 dòng) -->
<script>
    /**
     * Chèn biến template Django vào namespace toàn cục
     *
     * Chỉ chèn URL và cấu hình cần render tag template Django ở đây
     * Tất cả code logic đã được chuyển sang module JS riêng biệt
     */
    (function () {
        'use strict';

        // Chèn hằng số URL
        window.APP.URLS = {
            NAV_CONTENT: "{% url 'web_nav_content' %}",
            RENAME_ALIAS: "{% url 'web_rename_alias' %}",
            DEVICE_DETAIL: "{% url 'web_device_detail' %}",
            DEVICE_UPDATE: "{% url 'web_device_update' %}",
            DEVICE_STATUSES: "{% url 'web_device_statuses' %}",
            USER_UPDATE: "{% url 'web_user_update' %}",
            USER_RESET_PWD: "{% url 'web_user_reset_password' %}",
            USER_DELETE: "{% url 'web_user_delete' %}",
            USER_CREATE: "{% url 'web_user_create' %}",
            PERSONAL_LIST: "{% url 'web_personal_list' %}",
            PERSONAL_CREATE: "{% url 'web_personal_create' %}",
            PERSONAL_DELETE: "{% url 'web_personal_delete' %}",
            PERSONAL_RENAME: "{% url 'web_personal_rename' %}",
            PERSONAL_DETAIL: "{% url 'web_personal_detail' %}",
            PERSONAL_ADD_DEVICE: "{% url 'web_personal_add_device' %}",
            PERSONAL_REMOVE_DEVICE: "{% url 'web_personal_remove_device' %}",
            PERSONAL_UPDATE_ALIAS: "{% url 'web_personal_update_alias' %}",
            PERSONAL_UPDATE_TAGS: "{% url 'web_personal_update_tags' %}",
            LOGIN: "{% url 'web_login' %}",
            HOME: "{% url 'web_home' %}"
        };

        // Khởi tạo ứng dụng
        document.addEventListener('DOMContentLoaded', function () {
            APP.navigation.init();
            APP.events.init();
        });
    })();
</script>

</body>
</html>
