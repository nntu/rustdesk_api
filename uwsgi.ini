[uwsgi]
# Django-related settings
module = rustdesk_api.wsgi:application

# Process-related settings
master = true
processes = 4
threads = 20

# Socket/HTTP settings
# 注意：如需直接通过 HTTP 访问（或使用 Nginx 的 proxy_pass HTTP 反代），请使用 http-socket
# 如果使用 Nginx 的 uwsgi_pass，请改回 socket 并确保 nginx 配置包含 uwsgi_params
http-socket = 0.0.0.0:21114

# Logging
log-master = true
log-master-req = true
log-master-resp = true
log-ioerror = true
log-slow = 1000
log-date = true
log-format = %(addr) - %(user) [%(ltime)] "%(method) %(uri) %(proto)" %(status) %(size) "%(referer)" "%(uagent)"

# 主日志输出到stdout（控制台）
logto = /dev/stdout

# 同时将日志写入文件，保留前台输出
logger = file:./logs/uwsgi.log
log-reopen = true

# Other settings
vacuum = true
pidfile = ./uwsgi.pid
max-requests = 5000
die-on-term = true
# 确保uWSGI在前台运行
no-daemonize = true
# 允许uWSGI接收SIGTERM信号
reload-mercy = 8
worker-reload-mercy = 8

# Static files serving (for development only)
# In production, serve static files with a web server like Nginx
# static-map = /static=/app/static

# Increase buffer size to handle larger requests
buffer-size = 32768